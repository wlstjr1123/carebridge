<!-- 
  1:1 문의 상세 페이지 템플릿
  
  목적: 1:1 문의의 상세 내용을 확인하고 답변을 작성할 수 있는 관리자 페이지
    - 사용자 경험(UX) 개선: 관리자가 문의 내용을 확인하고 답변을 작성할 수 있도록 함
    - 데이터 표시: 문의 작성자 정보, 문의 제목 및 내용을 표시
    - 답변 기능: 문의에 대한 답변을 작성하고 저장하는 기능 제공
    - 액션 처리: 답변 완료 또는 답변 취소 기능 제공
  
  주요 기능:
    - 문의 상세 정보 표시: 작성자 정보, 연락처, 이메일, 제목, 내용 표시
    - 답변 작성: 문의에 대한 답변을 작성하고 저장
    - 답변 취소: 작성한 답변을 취소하고 삭제
    - 이메일 링크: 작성자 이메일을 클릭하면 메일 클라이언트 실행
  
  관련 파일:
    - CSS: admin_common.css, qna_detail.css
    - JavaScript: admin_common.js, qna_detail.js
-->
{% load static %}
{% load masking_filters %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <!-- 
    HTML 문서 메타 정보
    
    목적: 문서의 기본 정보 및 설정
      - charset: UTF-8 인코딩 설정 (한글 지원)
      - viewport: 반응형 디자인을 위한 뷰포트 설정
      - title: 브라우저 탭에 표시될 페이지 제목
  -->
  <meta charset="UTF-8">
  <!-- 
    뷰포트 설정
    
    목적: 모바일 기기에서 올바른 화면 크기로 표시되도록 설정
      - width=device-width: 기기의 실제 너비에 맞춤
      - initial-scale=1.0: 초기 확대/축소 비율 100%
      - minimum-scale=0.5: 최소 확대/축소 비율 50%
      - maximum-scale=2.0: 최대 확대/축소 비율 200%
  -->
  <link rel="icon" href="{% static 'core/img/favicon.png' %}" type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0">
  <title>문의 답변하기 - CareBridge 관리자</title>
  
  <!-- 
    CSS 파일 로드
    
    목적: 페이지 스타일링을 위한 CSS 파일 로드
      - admin_common.css: 관리자 패널 공통 스타일
      - qna_detail.css: 문의 상세 페이지 전용 스타일
  -->
  <link rel="stylesheet" href="{% static 'admin_panel/css/admin_common.css' %}">
  <link rel="stylesheet" href="{% static 'admin_panel/css/qna_detail.css' %}">
</head>
<body class="qna-detail-body">
  {% comment %}
    헤더 섹션
    
    목적: 페이지 상단에 로고와 사용자 정보, 로그아웃 버튼을 표시
      - 로고: CareBridge 로고 이미지 및 대시보드 링크
      - 사용자 정보: 로그인한 관리자 이름 표시
      - 로그아웃 버튼: 로그아웃 기능 제공
      - 공통 헤더 템플릿 사용: core/header.html
  {% endcomment %}
  {% include 'core/_header.html' %}

  <!-- 
    메인 컨테이너
    
    목적: 페이지의 주요 내용을 담는 컨테이너
      - CSS 클래스: 
        → container: 컨테이너 스타일
        → qna-detail-page: 문의 상세 페이지 전용 스타일
      - 내용: 탭, 문의 상세 정보, 답변 입력 영역
  -->
  <div class="container qna-detail-page">
    <!-- 
      상단 탭 메뉴
      
      목적: 관리자 패널의 각 페이지로 이동할 수 있는 탭 메뉴
        - 사용자 경험(UX) 개선: 관리자가 쉽게 다른 페이지로 이동할 수 있도록 함
        - 현재 페이지 표시: active 클래스로 현재 페이지 표시 (없음 - 상세 페이지이므로)
    -->
    <div class="tabs">
      <!-- 
        사용자목록 탭
        
        목적: 사용자 목록 페이지로 이동
          - href: {% url 'user_list' %} - 사용자 목록 URL
          - CSS 클래스: tab (탭 스타일)
      -->
      <a href="{% url 'user_list' %}" class="tab">사용자목록</a>
      
      <!-- 
        의사목록 탭
        
        목적: 의사 목록 페이지로 이동
          - href: {% url 'doctor_list' %} - 의사 목록 URL
          - CSS 클래스: tab (탭 스타일)
      -->
      <a href="{% url 'doctor_list' %}" class="tab">의사목록</a>
      
      <!-- 
        병원정보 탭
        
        목적: 병원 정보 페이지로 이동
          - href: {% url 'hospital_list' %} - 병원 정보 URL
          - CSS 클래스: tab (탭 스타일)
      -->
      <a href="{% url 'hospital_list' %}" class="tab">병원정보</a>
      
      <!-- 
        승인대기 탭
        
        목적: 승인 대기 페이지로 이동
          - href: {% url 'approval_pending' %} - 승인 대기 URL
          - CSS 클래스: tab (탭 스타일)
      -->
      <a href="{% url 'approval_pending' %}" class="tab">승인대기</a>
      
      <!-- 
        1:1문의관리 탭
        
        목적: 1:1 문의 관리 페이지로 이동
          - href: {% url 'qna_list' %} - 1:1 문의 목록 URL
          - CSS 클래스: tab (탭 스타일)
      -->
      <a href="{% url 'qna_list' %}" class="tab">1:1문의관리</a>
    </div>

    <!-- 
      문의 상세 컨테이너
      
      목적: 문의 상세 정보와 답변 입력 영역을 담는 컨테이너
        - CSS 클래스: qna-detail-container (문의 상세 컨테이너 스타일)
        - 내용: 페이지 제목, 문의 상세 정보, 답변 입력 폼
    -->
    <div class="qna-detail-container">
      <!-- 
        페이지 제목
        
        목적: 페이지의 제목 표시
          - CSS 클래스: qna-detail-title (제목 스타일)
          - 텍스트: "문의 답변하기"
      -->
      <h1 class="qna-detail-title">문의 답변하기</h1>

      <!-- 
        문의 상세 정보 섹션
        
        목적: 문의 작성자 정보와 문의 내용을 표시
          - 사용자 경험(UX) 개선: 관리자가 문의 내용을 확인할 수 있도록 함
          - 데이터 표시: 작성자 정보, 연락처, 이메일, 제목, 내용을 표시
          - CSS 클래스: inquiry-section (문의 섹션 스타일)
      -->
      <div class="inquiry-section">
        <!-- 
          문의 섹션 제목
        
          목적: 문의 상세 정보 섹션의 제목 표시
            - CSS 클래스: inquiry-section-title (섹션 제목 스타일)
            - 텍스트: "문의 상세"
        -->
        <div class="inquiry-section-title">문의 상세</div>
        
        <!-- 
          작성자 정보 항목
          
          목적: 문의 작성자 정보를 표시
            - CSS 클래스: inquiry-detail-item (상세 정보 항목 스타일)
            - 라벨: "작성자"
            - 값: {{ qna.user.username }} ({{ qna.user.name }}) - 사용자 ID와 이름
              → qna: 문의 객체 (Qna 모델 인스턴스)
              → user: 문의 작성자 정보 (Users 모델 인스턴스)
              → username: 사용자 ID
              → name: 사용자 이름
        -->
        <div class="inquiry-detail-item">
          <span class="inquiry-detail-label">작성자</span>
          <span class="inquiry-detail-value">{{ qna.user.username }} ({{ qna.user.name }})</span>
        </div>
        
        <!-- 
          연락처 정보 항목 (마스킹 처리)
          
          목적: 문의 작성자의 연락처를 마스킹 처리하여 표시 (개인정보 보호)
            - 라벨: "연락처"
            - 값: 전화번호 마스킹 처리
              → 010 + 공백 + 첫 번째 숫자 + "****" + 공백 + "****"
              → 예: "010 7**** ****" (실제 전화번호: "010-7751-7593")
              → phone: 사용자의 전화번호
              → mask_phone: 전화번호 마스킹 필터
              → |default:"-": phone이 없으면 "-" 표시
        -->
        <div class="inquiry-detail-item">
          <span class="inquiry-detail-label">연락처</span>
          <span class="inquiry-detail-value">{{ qna.user.phone|mask_phone|default:"-" }}</span>
        </div>
        
        <!-- 
          이메일 정보 항목
          
          목적: 문의 작성자의 이메일을 표시
            - 라벨: "이메일"
            - 값: {{ qna.user.email }} - 사용자의 이메일 주소 (일반 텍스트로 표시)
              → 이메일은 클릭 불가능한 일반 텍스트로 표시
        -->
        <div class="inquiry-detail-item">
          <span class="inquiry-detail-label">이메일</span>
          <span class="inquiry-detail-value">{{ qna.user.email }}</span>
        </div>
        
        <!-- 
          제목 정보 항목
          
          목적: 문의 제목을 표시
            - 라벨: "제목"
            - 값: {{ qna.title }} - 문의 제목
              → title: 문의 제목
        -->
        <div class="inquiry-detail-item">
          <span class="inquiry-detail-label">제목</span>
          <span class="inquiry-detail-value">{{ qna.title }}</span>
        </div>
        
        <!-- 
          내용 정보 항목
          
          목적: 문의 내용을 표시
            - 라벨: "내용"
            - 값: {{ qna.content }} - 문의 내용
              → content: 문의 내용
              → CSS 클래스: inquiry-content (문의 내용 스타일)
                → 긴 텍스트를 표시하기 위한 스타일 적용
        -->
        <div class="inquiry-detail-item">
          <span class="inquiry-detail-label">내용</span>
          <div class="inquiry-detail-value">
            <div class="inquiry-content">{{ qna.content }}</div>
          </div>
        </div>
      </div>

      <!-- 
        답변 입력 폼
        
        목적: 문의에 대한 답변을 작성하고 저장하는 폼
          - method="post": POST 메서드로 서버에 데이터 전송
          - action: {% url 'qna_detail' qna.qna_id %} - 문의 상세 페이지 URL
            → qna.qna_id: 문의 ID (URL 파라미터)
          - CSRF 토큰: CSRF 공격 방지를 위한 토큰 필수
      -->
      <form id="qndFrom" method="post" action="{% url 'qna_detail' qna.qna_id %}">
        <!-- 
          CSRF 토큰
          
          목적: CSRF 공격 방지를 위한 토큰
            - {% csrf_token %}: Django의 CSRF 토큰 생성
            - POST 요청 시 필수
        -->
        {% csrf_token %}
        
        <!-- 
          답변 입력 영역
          
          목적: 답변 내용을 입력하는 영역
            - CSS 클래스: reply-section (답변 섹션 스타일)
        -->
        <div class="reply-section">
          <!-- 
            답변 섹션 제목
          
          목적: 답변 입력 영역의 제목 표시
            - CSS 클래스: reply-section-title (섹션 제목 스타일)
            - 텍스트: "답변 내용"
          -->
          <div class="reply-section-title">답변 내용</div>
          
          <!-- 
            답변 입력 텍스트 영역
            
            목적: 답변 내용을 입력하는 텍스트 영역
              - name="reply_content": 서버에서 답변 내용을 읽기 위한 필드 이름
              - CSS 클래스: reply-textarea (답변 텍스트 영역 스타일)
              - placeholder: "문의에 대한 답변을 입력해 주세요." - 사용자 안내 메시지
              - value: {{ qna.reply|default:"" }} - 기존 답변 내용 (있는 경우)
                → reply: 문의에 대한 답변 내용
                → |default:""": reply가 없으면 빈 문자열 표시
                → 기존 답변이 있으면 수정 가능, 없으면 새로 작성
          -->
          <textarea 
            name="reply_content" 
            class="reply-textarea" 
            placeholder="문의에 대한 답변을 입력해 주세요."
          >{{ qna.reply|default:"" }}</textarea>
        </div>

        <!-- 
          액션 버튼 영역
          
          목적: 답변 완료 또는 답변 취소 버튼을 표시
            - CSS 클래스: action-buttons (액션 버튼 영역 스타일)
            - 버튼: 답변 취소 (답변이 없는 경우만), 답변 완료
        -->
        <div class="action-buttons">
          {% comment %}
            답변 취소 버튼
            
            목적: 작성한 답변을 취소하고 삭제
              - 조건: 답변이 없는 경우에만 표시 ({% if not qna.reply %})
              - type="submit": 폼 제출 버튼
              - name="action": 액션 타입 필드 이름
              - value="cancel": 액션 값 (답변 취소)
              - CSS 클래스: btn-cancel (취소 버튼 스타일)
              - 텍스트: "답변 취소"
              - 동작: 서버에서 action 값이 "cancel"이면 답변을 삭제
          {% endcomment %}
          {% if not qna.reply %}
            <button type="button" name="action" value="cancel" class="btn-cancel" id="cancelBtn">답변 취소</button>
          {% endif %}
          
          <!-- 
            답변 완료 버튼
            
            목적: 작성한 답변을 저장하고 완료 처리
              - type="button": JavaScript에서 제어하기 위해 button 타입 사용
              - name="action": 액션 타입 필드 이름
              - value="reply": 액션 값 (답변 완료)
              - CSS 클래스: btn-complete (완료 버튼 스타일)
              - 텍스트: "답변 완료"
              - 동작: JavaScript에서 확인 후 서버로 제출
          -->
          <button type="button" name="action" value="reply" class="btn-complete" id="replyBtn">답변 완료</button>
        </div>
      </form>
    </div>
  </div>

  <!-- 
    JavaScript 파일 로드
    
    목적: 페이지의 동적 기능을 제공하기 위한 JavaScript 파일 로드
      - 로드 순서: admin_common.js를 먼저 로드한 후 qna_detail.js를 로드
      - admin_common.js: 관리자 패널 공통 JavaScript 함수들
        → 로그아웃 버튼 이벤트 처리 등 공통 기능
      - qna_detail.js: 문의 상세 페이지 전용 JavaScript 함수들
        → 문의 상세 페이지에 특화된 기능들 (현재는 공통 함수만 사용)
  -->
  <script src="{% static 'admin_panel/js/admin_common.js' %}"></script>
  <script src="{% static 'admin_panel/js/qna_detail.js' %}"></script>
</body>
</html>



