{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="icon" href="{% static 'core/img/favicon.png' %}" type="image/png">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>근처 병원 예약하기</title>

  <script
    type="text/javascript"
    src="//dapi.kakao.com/v2/maps/sdk.js?appkey={{ KAKAO_MAP_JS_KEY }}&libraries=services"></script>

  <script>
    const ACTIVE_DEPT = "{{ active_dept|default:'' }}";
  </script>

  <link rel="stylesheet" href="{% static 'reservations/css/main.css' %}">
</head>

<body class="reservation-body">
  {% include "core/_header.html" %}

  <main class="reservation-main">
    <div class="page">
      <header class="hospital-header">
        <h1 class="hospital_title">근처 병원 예약</h1>
      </header>

      <div class="main">
        <aside class="sidebar">
          <button class="dept-btn" data-dept="내과">내과</button>
          <button class="dept-btn" data-dept="외과">외과</button>
          <button class="dept-btn" data-dept="정형외과">정형외과</button>
          <button class="dept-btn" data-dept="이비인후과">이비인후과</button>
          <button class="dept-btn" data-dept="소아과">소아과</button>
        </aside>

        <section class="map-wrapper">
          <div id="map"></div>
        </section>
      </div>

    <section class="card-section">
      <div class="card-header">
        <h3 class="card-title">내 주변 병원</h3>
        <p class="card-subtitle">현재 위치 기준 가까운 병원 Top 5를 보여줍니다.</p>
      </div>

      <div class="card-row" id="hospitalCards"></div>
    </section>
    </div>
  </main>

  <!-- 모달/스크립트는 기존 그대로 -->
  <div id="hospitalModal" class="modal hidden">
    <form id="reservationForm" method="post" action="{% url 'reservation_page' %}">
      {% csrf_token %}
      <input type="hidden" name="hospital_id" id="reservationHospitalId">
      <input type="hidden" name="department_id" id="reservationDepartmentId">
    </form>

    <div class="modal-backdrop"></div>
    <div class="modal-dialog">
      <button class="modal-favorite" type="button">★</button><br>
      <div class="modal-content">
        <table class="modal-info-table">
          <tbody>
            <tr>
              <th>병원이름</th>
              <td class="modal-hospital-name"></td>
              <th>진료과목</th>
              <td class="modal-dept"></td>
            </tr>
            <tr>
              <th>시도 명</th>
              <td class="modal-city"></td>
              <th>전화번호</th>
              <td class="modal-phone"></td>
            </tr>
            <tr>
              <th>영업시간</th>
              <td class="modal-hours" colspan="3"></td>
            </tr>
            <tr>
              <th>주소</th>
              <td class="modal-address" colspan="3"></td>
            </tr>
            <tr>
              <th>평점</th>
              <td class="modal-rating" colspan="3"></td>
            </tr>
          </tbody>
        </table>

        <div class="modal-footer">
          <button id="modalReserveBtn" type="button" class="btn-primary">예약하기</button>
          <button id="modalCancelBtn" type="button" class="btn-secondary">취소</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const TOGGLE_FAVORITE_URL = "{% url 'toggle_favorite' %}";
  </script>

  <script id="hospital-data" type="application/json">
    {{ hospital_json|safe }}
  </script>

  <script src="{% static 'reservations/js/main.js' %}"></script>

  <footer class="footer">
    <div class="footer-container">
      <h2 class="footer-brand-name">CareBridge</h2>
      <div class="footer-info">
        <p class="footer-info-line">
          CareBridge 대표자명 : 디버깅내과 | 주소 : 서울특별시 강남구 현익빌딩 | 대표전화 : 02-000-0000
        </p>
      </div>
      <div class="footer-copyright">
        COPYRIGHT © CareBridge ALL RIGHTS RESERVED.
      </div>
    </div>
  </footer>
</body>
</html>
